<!-- https://www.amocrm.ru/developers/content/digital_pipeline/webhooks -->

# Webhooks

### Webhooks в digital pipeline

Webhooks – это уведомление сторонних приложений посредством отправки уведомлений о событиях, произошедших в amoCRM. Вы можете настроить HTTP адреса ваших приложений и связанные с ними рабочие правила в настройках digital pipeline, в amoCRM.

Подробнее о технологии можно посмотреть в разделе [WebHooks](/crm_platform/webhooks-api.html) REST API. Однако, не смотря на тот факт, что применяемая технология уведомлений Webhooks в digital pipeline такая же, как и в разделе amoМаркет вашего аккаунта, она имеет несколько отличий.

*   Первое отличие, более ограниченный список событий по которым будет реагировать отправка уведомлений.
*   Второе отличие, из digital pipeline, в отличии от amoМаркет, webhook отправляется только один раз, по произошедшему указанному событию. Без попыток повторной отправки.

Список возможных событий

*   При заполнении анкеты
*   При входящем письме
*   При входящем звонке
*   После захода на сайт

#### Чтобы создать webhook

Пройдите в меню настроек digital pipeline из раздела Сделки/Покупатели и выберите "добавить триггер", под нужным вам этапом..

![](https://i.postimg.cc/bJnmzPmZ/add-trigger.png)

Далее выберите "API: отправить webhook".

![](https://i.postimg.cc/k5g43XXp/api-webhook.png)

Выберите событие, при котором будет отправляться webhook.

![](https://i.postimg.cc/XNdnPykG/pick-event.png)

Введите URL, по которому будет отправляться webhook.

![](https://i.postimg.cc/Px10S1nx/add-condition.png)

#### Формат отправляемых данных

Webhook отправляет на стороннее приложение POST переменную, которая содержит массив вида {"entity":{"action":{массив полей сущности\}\}}.

#### Параметры

| Параметр | Описание |
| --- | --- |
| leads | Сущность: "Сделка" |
| customers | Сущность: "Покупатель" |

#### Параметры событий

| Параметр | Описание |
| --- | --- |
| call\_in | Событие при входящем вызове |
| chat | Событие при входящем сообщении из чата |
| site\_visit | Событие при заходе на сайт |
| mail\_in | Событие при входящем письме |
| status | Событие при переходе в этап, только у сделок |
| period | Событие при смене периода, только у покупателя |

#### Параметры полей сущности

| Параметр | Описание |
| --- | --- |
| id | id элемента сущности |
| old\_pipeline\_id | id старой цифровой воронки, только у сделок |
| pipeline\_id | id новой цифровой воронки, только у сделок |
| old\_status\_id | id старого статуса, только у сделок |
| status\_id | id нового статуса, только у сделок |
| old\_period\_id | id старого периода, только у покупателя |
| period\_id | id нового периода, только у покупателя |

#### Пример

При входящем письме, для сделки

```javascript
{
    "leads": {
        "mail_in": [
            {
                "id": 4921027,
                "pipeline_id": 752662,
                "status_id": 16203334
            }
        ]
    }
}
```

При переходе в этап, для сделки

```javascript
{
    "leads": {
        "status": [
            {
                "id": 4831596,
                "old_pipeline_id": 752662,
                "pipeline_id": 752662,
                "old_status_id": 16203334,
                "status_id": 16203337
            }
        ]
    }
}
```