<!-- https://www.amocrm.ru/developers/content/crm_platform/filters-api -->

# Фильтрация (Alpha)

### Общая информация

Функционал API-фильтрации доступен для подключения в разделе «Настройки» → «Счета и оплата». Информацию о ценообразовании подключения функционала, вы можете посмотреть в «Дополнительные пакеты» по [ссылке](https://www.amocrm.ru/buy#additional-pricing).

Если вы хотите подключить фильтрацию для разработки интеграции — пожалуйста, обратитесь в чат поддержки интеграторов из вашего технического аккаунта.

Подробнее о техническом аккаунте вы можете узнать по [ссылке](/integrations/intro#registration:~:text=%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D1%8B%D0%B9%20%D0%BC%D1%8B%20%D0%BD%D0%B0%D0%B7%D1%8B%D0%B2%D0%B0%D0%B5%D0%BC-,%D1%82%D0%B5%D1%85%D0%BD%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%BC.,-%D0%9F%D0%BE%D1%81%D0%BB%D0%B5%20%D1%80%D0%B5%D0%B3%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%86%D0%B8%D0%B8%20%D0%B0%D0%BA%D0%BA%D0%B0%D1%83%D0%BD%D1%82%D0%B0.html)

Данный функционал доступен для следующих списков: [сделки](/crm_platform/leads-api.html), [контакты](/crm_platform/contacts-api.html), [компании](/crm_platform/companies-api.html) и [покупатели](/crm_platform/customers-api.html).

### Оглавление

*   [Общая информация](/crm_platform/filters-api#common-info.html)
*   [Фильтрация списка сделок](/crm_platform/filters-api#leads-filter.html)
*   [Фильтрация списка контактов](/crm_platform/filters-api#contacts-filter.html)
*   [Фильтрация списка компаний](/crm_platform/filters-api#companies-filter.html)
*   [Фильтрация списка покупателей](/crm_platform/filters-api#customers-filter.html)
*   [Типы фильтров](/crm_platform/filters-api#filter-types.html)

### Фильтрация списка сделок

#### Метод

GET /api/v4/leads

#### Описание

Метод позволяет получить список сделок с учетом переданного фильтра.

#### Ограничения

Метод доступен в соответствии с правами пользователя.

#### GET параметры

| Параметр | Тип данных | Описание | Множествен. | Диапазон. |
| --- | --- | --- | --- | --- |
| filter | object | Фильтр |  |  |
| filter\[id\] | int|array | Фильтр по ID сделок | ✅ | ❌ |
| filter\[name\] | string|array | Фильтр по названию сделки | ✅ | ❌ |
| filter\[price\] | object | Фильтр по бюджету сделки | ❌ | ✅ |
| filter\[statuses\] | array | Фильтр по статусам сделки | ❌ | ❌ |
| filter\[pipeline\_id\] | int|array | Фильтр по ID воронок | ✅ | ❌ |
| filter\[created\_by\] | int|array | Фильтр по ID пользователей, которые создали сущность | ✅ | ❌ |
| filter\[updated\_by\] | int|array | Фильтр по ID пользователей, которые изменили сущность последними | ✅ | ❌ |
| filter\[responsible\_user\_id\] | int|array | Фильтр по ID пользователей, которые являются ответственными за сущности | ✅ | ❌ |
| filter\[created\_at\] | object | Фильтр по дате создания сделки | ❌ | ✅ |
| filter\[updated\_at\] | object | Фильтр по дате изменения сделки | ❌ | ✅ |
| filter\[closed\_at\] | object | Фильтр по дате закрытия сделки | ❌ | ✅ |
| filter\[closest\_task\_at\] | object | Фильтр по дате ближайшей к выполнению задаче | ❌ | ✅ |
| filter\[custom\_fields\_values\] | object | Фильтр по значениям дополнительных полей | Зависит от типа поля | Зависит от типа поля |
| query | string | Строка, по которой будет произведен поиск. **В ближайшее время параметр будет признан устаревшим** |  |  |

### Фильтрация списка контактов

#### Метод

GET /api/v4/contacts

#### Описание

Метод позволяет получить список контактов с учетом переданного фильтра.

#### Ограничения

Метод доступен в соответствии с правами пользователя.

#### GET параметры

| Параметр | Тип данных | Описание | Множествен. | Диапазон. |
| --- | --- | --- | --- | --- |
| filter | object | Фильтр |  |  |
| filter\[id\] | int|array | Фильтр по ID контактов | ✅ | ❌ |
| filter\[name\] | string|array | Фильтр по названию контакта | ✅ | ❌ |
| filter\[created\_by\] | int|array | Фильтр по ID пользователей, которые создали сущность | ✅ | ❌ |
| filter\[updated\_by\] | int|array | Фильтр по ID пользователей, которые изменили сущность последними | ✅ | ❌ |
| filter\[responsible\_user\_id\] | int|array | Фильтр по ID пользователей, которые являются ответственными за сущности | ✅ | ❌ |
| filter\[created\_at\] | object | Фильтр по дате создания контакта | ❌ | ✅ |
| filter\[updated\_at\] | object | Фильтр по дате изменения контакта | ❌ | ✅ |
| filter\[closest\_task\_at\] | object | Фильтр по дате ближайшей к выполнению задаче | ❌ | ✅ |
| filter\[custom\_fields\_values\] | object | Фильтр по значениям дополнительных полей | Зависит от типа поля | Зависит от типа поля |
| query | string | Строка, по которой будет произведен поиск. **В ближайшее время параметр будет признан устаревшим** |  |  |

### Фильтрация списка компаний

#### Метод

GET /api/v4/companies

#### Описание

Метод позволяет получить список компаний с учетом переданного фильтра.

#### Ограничения

Метод доступен в соответствии с правами пользователя.

#### GET параметры

| Параметр | Тип данных | Описание | Множествен. | Диапазон. |
| --- | --- | --- | --- | --- |
| filter | object | Фильтр |  |  |
| filter\[id\] | int|array | Фильтр по ID компаний | ✅ | ❌ |
| filter\[name\] | string|array | Фильтр по названию компании | ✅ | ❌ |
| filter\[created\_by\] | int|array | Фильтр по ID пользователей, которые создали сущность | ✅ | ❌ |
| filter\[updated\_by\] | int|array | Фильтр по ID пользователей, которые изменили сущность последними | ✅ | ❌ |
| filter\[responsible\_user\_id\] | int|array | Фильтр по ID пользователей, которые являются ответственными за сущности | ✅ | ❌ |
| filter\[created\_at\] | object | Фильтр по дате создания компании | ❌ | ✅ |
| filter\[updated\_at\] | object | Фильтр по дате изменения компании | ❌ | ✅ |
| filter\[closest\_task\_at\] | object | Фильтр по дате ближайшей к выполнению задаче | ❌ | ✅ |
| filter\[custom\_fields\_values\] | object | Фильтр по значениям дополнительных полей | Зависит от типа поля | Зависит от типа поля |
| query | string | Строка, по которой будет произведен поиск. **В ближайшее время параметр будет признан устаревшим** |  |  |

### Фильтрация списка покупателей

#### Метод

GET /api/v4/customers

#### Описание

Метод позволяет получить список покупателей с учетом переданного фильтра.

#### Ограничения

Метод доступен в соответствии с правами пользователя.

#### GET параметры

| Параметр | Тип данных | Описание | Множествен. | Диапазон. |
| --- | --- | --- | --- | --- |
| filter | object | Фильтр |  |  |
| filter\[id\] | int|array | Фильтр по ID покупателей | ✅ | ❌ |
| filter\[name\] | string|array | Фильтр по названию покупателя | ✅ | ❌ |
| filter\[next\_price\] | string|array | Фильтр по ожидаемой сумме следующей покупки | ❌ | ✅ |
| filter\[next\_date\] | object | Фильтр по ожидаемой дате следующей покупки | ❌ | ✅ |
| filter\[status\_id\] | int|array | Фильтр по ID статуса покупателей | ✅ | ❌ |
| filter\[created\_by\] | int|array | Фильтр по ID пользователей, которые создали сущность | ✅ | ❌ |
| filter\[updated\_by\] | int|array | Фильтр по ID пользователей, которые изменили сущность последними | ✅ | ❌ |
| filter\[responsible\_user\_id\] | int|array | Фильтр по ID пользователей, которые являются ответственными за сущности | ✅ | ❌ |
| filter\[created\_at\] | object | Фильтр по дате создания компании | ❌ | ✅ |
| filter\[updated\_at\] | object | Фильтр по дате изменения компании | ❌ | ✅ |
| filter\[closest\_task\_at\] | object | Фильтр по дате ближайшей к выполнению задаче | ❌ | ✅ |
| filter\[custom\_fields\_values\] | object | Фильтр по значениям дополнительных полей | Зависит от типа поля | Зависит от типа поля |

### Типы фильтров

В данный момент доступно несколько типов фильтров.

*   Одиночный
*   Множественный
*   Диапазонный
*   Фильтр по статусам (только для сделок)
*   Фильтр по дополнительным полям

Каждый из них рассмотрим ниже с примерами.

#### Одиночный

Самый простой фильтр, который доступен. Принимает одно строковое значение.

Пример запроса

```javascript
/api/v4/leads?filter[name]=Сделка
```

#### Множественный

Расширенный вариант одиночного фильтра. Принимает несколько строковых значений.

Пример запроса

```javascript
/api/v4/leads?filter[pipeline_id][0]=15314&filter[pipeline_id][1]=21856
```

#### Диапазонный

Фильтр, который позволяет фильтровать числовые значение по диапазону ОТ-ДО.

Если фильтр установлен по значением полей, в которых хранится timestamp, то необходимо передавать в фильтр timestamp значения.

Фильтр доступен для следующих полей:

*   price
*   next\_price
*   next\_date
*   created\_at
*   updated\_at
*   closed\_at
*   closest\_task\_at
*   Поля типа date, date\_time, numeric

Пример запроса

```javascript
/api/v4/leads?filter[updated_at][from]=1575296400&filter[updated_at][to]=1589540009
```

#### Фильтр по статусам

Фильтр, который позволяет фильтровать сделки по нахождению в конкретных статусах.

Фильтр принимает массив, у каждого объекта массива есть 2 обязательных поля – pipeline\_id и status\_id.

Пример запроса

```javascript
/api/v4/leads?filter[statuses][0][pipeline_id]={pipeline_id}&filter[statuses][0][status_id]={status_id}
```

#### Фильтр по дополнительным полям

Фильтр, который позволяет фильтровать сделки по значению нескольких дополнительных полей.

Для разных типов полей необходимы разные значения в фильтре.

*   Для полей numeric, text, url, textarea, streetaddress в значение фильтра передается значение поля
*   Для полей select, multiselect, radiobutton в значение фильтра передается ID enum значения
*   Для поля checkbox в значение фильтра передается 1 или 0

Для разных типов полей доступны разные подходы к фильтрации.

Поля, которые поддерживают фильтр по диапазону:

*   date
*   date\_time
*   numeric

Поля, которые поддерживают множественный выбор:

*   numeric
*   text
*   url
*   textarea
*   streetaddress
*   select
*   multiselect
*   radiobutton

Пример запроса

```javascript
/api/v4/leads?filter[custom_fields_values][{field_id}][]={value}&filter[custom_fields_values][{field_id}][]={value2}
/api/v4/leads?filter[custom_fields_values][{field_id}][]={enum_id}&filter[custom_fields_values][{field_id}][]={enum_id2}
/api/v4/leads?filter[custom_fields_values][{field_id}][from]={date_from}&filter[custom_fields_values][{field_id}][to]={date_to}
```